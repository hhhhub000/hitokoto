# ひとこと日記 Webアプリ 仕様書

## 1. 概要
本仕様書は「ひとこと日記」Webアプリケーションの技術仕様を定義するものです。

## 2. 技術スタック
- **フロントエンド**: React 18 + TypeScript + Vite + Tailwind CSS + Zustand
- **バックエンド**: Node.js + Express + TypeScript
- **ファイル管理**: Multer (画像アップロード)
- **データベース**: モックデータサービス（メモリ内）

## 3. UI（画面）

### 3.1 投稿画面 (`/create`, `/edit/:id`)
**実装状況**: ✅ 完了
- 日記投稿フォームの表示
- テキスト入力エリア（140文字制限、リアルタイム文字数表示）
- 写真アップロード機能（プレビュー表示）
- バリデーション（必須入力チェック、文字数制限）
- 投稿・更新・キャンセルボタン

### 3.2 一覧画面 (`/`)
**実装状況**: ✅ 完了
- 投稿済み日記の表示（カード形式）
- 新しい順でのソート表示
- ページネーション（10件/ページ）
- 日記がない場合の空状態表示
- 各日記への編集・削除・詳細リンク

### 3.3 詳細画面 (`/diary/:id`)
**実装状況**: ✅ 完了
- 個別日記の詳細表示
- 編集・削除ボタン
- 一覧への戻るリンク
- 投稿日時の表示

### 3.4 レイアウト・ナビゲーション
**実装状況**: ✅ 完了
- ヘッダーナビゲーション
- レスポンシブデザイン（Tailwind CSS）
- ページ間の画面遷移（React Router）

## 4. 日記の投稿機能

### 4.1 テキスト投稿
**実装状況**: ✅ 完了
- 140文字以内のテキスト入力
- リアルタイム文字数カウント
- 必須入力バリデーション

### 4.2 写真アップロード
**実装状況**: ✅ 完了
- 画像ファイルのアップロード（JPEG, PNG, GIF対応）
- 最大ファイルサイズ: 5MB
- 画像プレビュー機能
- ファイル形式・サイズのバリデーション

### 4.3 バリデーション
**実装状況**: ✅ 完了
- フロントエンド: 即座入力チェック
- バックエンド: サーバーサイドバリデーション
- エラーメッセージの表示

## 5. 日記の一覧表示機能

### 5.1 一覧取得
**実装状況**: ✅ 完了
- 投稿済み日記の取得・表示
- 新しい順でのソート
- ページネーション対応

### 5.2 検索・フィルタ
**実装状況**: 🔄 部分実装（バックエンドのみ）
- キーワード検索（テキスト内容）
- 日付範囲での絞り込み
- **TODO**: フロントエンドUI実装予定

### 5.3 操作機能
**実装状況**: ✅ 完了
- 編集機能（テキストのみ）
- 削除機能（確認ダイアログ付き）
- 詳細表示

## 6. データベース機能

### 6.1 データモデル
**実装状況**: ✅ 完了
```typescript
interface Diary {
  id: string;          // UUID
  text: string;        // 140文字以内
  imageUrl?: string;   // 画像ファイルパス（任意）
  createdAt: Date;     // 作成日時
  updatedAt: Date;     // 更新日時
}
```

### 6.2 CRUD操作
**実装状況**: ✅ 完了
- **CREATE**: `POST /api/diaries` - 新規日記作成
- **READ**: `GET /api/diaries` - 一覧取得, `GET /api/diaries/:id` - 個別取得
- **UPDATE**: `PUT /api/diaries/:id` - 日記更新
- **DELETE**: `DELETE /api/diaries/:id` - 日記削除

### 6.3 ファイル管理
**実装状況**: ✅ 完了
- 画像ファイルの保存（`/uploads`ディレクトリ）
- ユニークファイル名生成（UUID）
- ファイル配信（静的ファイル提供）

## 7. API仕様

### 7.1 エンドポイント一覧
| メソッド | エンドポイント | 説明 | 実装状況 |
|---------|---------------|------|----------|
| GET | `/api/diaries` | 日記一覧取得 | ✅ |
| GET | `/api/diaries/:id` | 個別日記取得 | ✅ |
| POST | `/api/diaries` | 日記作成 | ✅ |
| PUT | `/api/diaries/:id` | 日記更新 | ✅ |
| DELETE | `/api/diaries/:id` | 日記削除 | ✅ |

### 7.2 リクエスト・レスポンス形式
**共通レスポンス形式**:
```typescript
interface ApiResponse<T> {
  success: boolean;
  data?: T;
  error?: string;
  message?: string;
}
```

## 8. 状態管理

### 8.1 Zustand Store
**実装状況**: ✅ 完了
- 日記データの一元管理
- API呼び出しの抽象化
- ローディング・エラー状態の管理
- ページネーション状態の管理

## 9. 今後の拡張予定

### 9.1 フロントエンド機能
- [ ] 検索・フィルタUI
- [ ] 画像のリサイズ・圧縮
- [ ] PWA対応
- [ ] ダークモード

### 9.2 バックエンド機能
- [ ] 実際のデータベース接続（SQLite/PostgreSQL）
- [ ] ユーザー認証
- [ ] 画像の最適化処理
- [ ] バックアップ機能

### 9.3 テスト
- [ ] ユニットテスト（Jest）
- [ ] 統合テスト
- [ ] E2Eテスト

---

**作成日**: 2025年9月28日  
**バージョン**: 1.0  
**最終更新**: 2025年9月28日